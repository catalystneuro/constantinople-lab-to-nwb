# The metadata of the fiber photometry setup
# papers with similar setup: https://www.biorxiv.org/content/10.1101/2023.12.09.570945v1.full.pdf
#                            https://www.biorxiv.org/content/10.1101/2024.05.03.592444v1.full.pdf
Ophys:
  FiberPhotometry:
    OpticalFibers:
      - name: optical_fiber
        description: The optical fibers (Thor labs) with 400 μm core, 0.5 NA fiber optics were implanted over the injection site.
        manufacturer: Thor labs
        # model: unknown
        numerical_aperture: 0.5
        core_diameter_in_um: 400.0
    ExcitationSources: # Can't find any information in the referred papers
      - name: excitation_source
        description: TBD
        manufacturer: Doric Lenses
        model: TBD
        illumination_type: LED
        excitation_wavelength_in_nm: 0.0 # TBD
      - name: excitation_source_isosbestic_control
        description: TBD
        manufacturer: Doric Lenses
        model: TBD
        illumination_type: LED
        excitation_wavelength_in_nm: 0.0 # TBD
    Photodetectors: # Can't find any information in the referred papers
      - name: photodetector
        description: TBD
        manufacturer: Doric Lenses
        model: TBD
        detector_type: photodiode
        detected_wavelength_in_nm: 0.0 # TBD
        # gain: # TBD
    BandOpticalFilters: # Can't find any information in the referred papers
      - name: emission_filter
        description: TBD
        manufacturer: Doric Lenses
        model: TBD
        center_wavelength_in_nm: 0.0 # TBD
        bandwidth_in_nm: 0.0 # TBD
        filter_type: Bandpass
      - name: excitation_filter
        description: TBD
        manufacturer: Doric Lenses
        model: TBD
        center_wavelength_in_nm: 0.0 # TBD
        bandwidth_in_nm: 0.0 # TBD
        filter_type: Bandpass
      - name: isosbestic_excitation_filter
        description: TBD
        manufacturer: Doric Lenses
        model: TBD
        center_wavelength_in_nm: 0.0 # TBD
        bandwidth_in_nm: 0.0 # TBD
        filter_type: Bandpass
    DichroicMirrors: # Can't find any information in the referred papers
      - name: dichroic_mirror
        description: TBD
        manufacturer: Doric Lenses
        model: TBD
    Indicators:
      - name: grab_da_dms
        description: "To measure dopamine activity, AAV9-hsyn-GRAB DA2h (AddGene #140554) was injected into the DMS (AP: -0.4 mm, ML: ±3.5 mm, DV: -4.6 mm from the skull surface at bregma at a 10 degrees angle)."
        manufacturer: Addgene
        label: AAV9-hSyn-GRAB
        injection_location: DMS
        injection_coordinates_in_mm: [-0.4, -3.5, -4.6]
      - name: grab_ach_dms
        description: "To measure acetylcholine activity, AAV9-hSyn-ACh4.3 (WZ Biosciences #YL10002) was injected into the DMS (AP: 1.7 mm, ML: ±2.8 mm, DV: -4.3 mm from the skull surface at bregma at a 10 degrees angle)."
        manufacturer: WZ Biosciences
        label: AAV9-hSyn-ACh4.3
        injection_location: DMS
        injection_coordinates_in_mm: [1.7, 2.8, -4.3]
      - name: grab_da_nacc
        description: "To measure dopamine activity, AAV9-hsyn-GRAB DA2h (AddGene #140554) was injected into the NAcc (AP: 1.3 mm, ML: 1.65 mm, DV:-6.9 mm with an 8-10 degrees angle from the midline for bilateral implants)."
        manufacturer: Addgene
        label: AAV9-hSyn-GRAB
        injection_location: NAcc
        injection_coordinates_in_mm: [1.3, 1.65, -6.9]
      - name: mcherry
        description: "The control fluorophore was mCherry (AAV9-CB7-CI-mCherry-WPRE-RBG, AddGene #105544)."
        label: AAV1-CB7-CI-mCherry
        manufacturer: Addgene
    FiberPhotometryTable:
      name: fiber_photometry_table
      description: TBD
      rows:
        - name: 0
          location: DMS
          # coordinates: [0.8, 1.5, 2.8]
          # commanded_voltage_series: commanded_voltage_series_dms_calcium_signal
          indicator: grab_da_dms
          optical_fiber: optical_fiber
          excitation_source: excitation_source
          photodetector: photodetector
          excitation_filter: excitation_filter
          emission_filter: emission_filter
          dichroic_mirror: dichroic_mirror
        - name: 1
          location: DLS
          # coordinates: [0.8, 1.5, 2.8]
          indicator: grab_da_dms
          optical_fiber: optical_fiber
          excitation_source: excitation_source
          photodetector: photodetector
          excitation_filter: excitation_filter
          emission_filter: emission_filter
          dichroic_mirror: dichroic_mirror
        - name: 2
          location: DMS
          # coordinates: [0.8, 1.5, 2.8]
          # commanded_voltage_series: commanded_voltage_series_dms_isosbestic_control
          indicator: mcherry
          optical_fiber: optical_fiber
          excitation_source: excitation_source_isosbestic_control
          photodetector: photodetector
          excitation_filter: isosbestic_excitation_filter
          emission_filter: emission_filter
          dichroic_mirror: dichroic_mirror
        - name: 3
          location: DLS
            # coordinates: [0.8, 1.5, 2.8]
          indicator: mcherry
          optical_fiber: optical_fiber
          excitation_source: excitation_source_isosbestic_control
          photodetector: photodetector
          excitation_filter: isosbestic_excitation_filter
          emission_filter: emission_filter
          dichroic_mirror: dichroic_mirror
    FiberPhotometryResponseSeries:
      - name: fiber_photometry_response_series_green
        description: The raw fluorescence signal # TBD
        stream_name: "/DataAcquisition/FPConsole/Signals/Series0001/AnalogIn"
        stream_indices: [1] #[1, 3]
        unit: a.u.
        fiber_photometry_table_region: [0] #[0, 1]
        fiber_photometry_table_region_description: The region of the FiberPhotometryTable corresponding to the raw fluorescence signal.
      - name: fiber_photometry_response_series_red
        description: The raw fluorescence signal # TBD
        stream_name: "/DataAcquisition/FPConsole/Signals/Series0001/AnalogIn/"
        stream_indices: [0, 2]
        unit: a.u.
        fiber_photometry_table_region: [2, 3]
        fiber_photometry_table_region_description: The region of the FiberPhotometryTable corresponding to the raw fluorescence signal.
